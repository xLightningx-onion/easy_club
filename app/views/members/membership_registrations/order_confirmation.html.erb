<div class="px-6 py-8 space-y-8">
  <div class="space-y-2 text-center">
    <h2 class="text-xl font-semibold text-slate-900">Order confirmation</h2>
    <p class="text-sm text-slate-600">Review your cart before completing payment.</p>
  </div>

  <% cart_items = @cart&.cart_items&.includes(:member, plan: :product) || [] %>

  <% if cart_items.any? %>
    <div class="space-y-4">
      <% cart_items.each do |item| %>
        <% product = item.plan&.product %>
        <% highlighted = @highlighted_cart_item && item.id == @highlighted_cart_item.id %>
        <% article_classes = ["rounded-xl", "border", "px-4", "py-4", "shadow-sm", "transition"] %>
        <% if highlighted %>
          <% article_classes << "border-emerald-400" << "bg-emerald-50/40" %>
        <% else %>
          <% article_classes << "border-slate-200" << "bg-white" %>
        <% end %>
        <article class="<%= article_classes.join(' ') %>">
          <div class="flex flex-col gap-3 md:flex-row md:items-center md:justify-between">
            <div class="space-y-1">
              <p class="text-sm font-semibold text-slate-900"><%= item.member.display_name %></p>
              <p class="text-xs text-slate-500">Membership: <%= product&.name || "Club membership" %></p>
              <p class="text-xs text-slate-500">Status: <%= item.member.status.to_s.humanize %></p>
            </div>
            <div class="text-right">
              <p class="text-sm font-semibold text-slate-900">
                <%= number_to_currency(item.total_price_cents / 100.0, unit: item.total_price_currency) %>
              </p>
              <p class="text-xs text-slate-500">Qty <%= item.quantity %></p>
            </div>
          </div>
        </article>
      <% end %>
    </div>

    <div class="flex flex-col gap-4 rounded-xl border border-slate-200 bg-white px-4 py-4 md:flex-row md:items-center md:justify-between">
      <div>
        <p class="text-sm text-slate-500">Cart total</p>
        <p class="text-lg font-semibold text-slate-900">
          <%= number_to_currency(@cart.total_cents / 100.0, unit: @cart.total_currency) %>
        </p>
      </div>
      <div class="flex flex-col gap-2 md:flex-row">
        <%= link_to "Add another membership",
                    members_membership_registration_path(step: "personal", club_id: @club.id, restart: true),
                    class: "inline-flex items-center justify-center rounded-full border border-slate-300 px-5 py-2 text-sm font-semibold text-slate-700 transition hover:border-slate-400 hover:text-slate-900" %>
        <%= link_to "Pay now",
                    club_cart_path,
                    class: "inline-flex items-center justify-center rounded-full bg-slate-900 px-6 py-3 text-sm font-semibold text-white shadow transition hover:bg-slate-800" %>
      </div>
    </div>
  <% else %>
    <div class="rounded-xl border border-dashed border-slate-200 bg-slate-50 px-6 py-10 text-center">
      <p class="text-sm text-slate-500">Your cart is empty. Add a membership to continue.</p>
      <div class="mt-4 flex justify-center">
        <%= link_to "Start a membership",
                    members_membership_registration_path(step: "personal", club_id: @club.id, restart: true),
                    class: "inline-flex items-center justify-center rounded-full bg-slate-900 px-6 py-3 text-sm font-semibold text-white shadow transition hover:bg-slate-800" %>
      </div>
    </div>
  <% end %>
</div>
