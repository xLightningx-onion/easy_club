<% content_for :title, "#{@club.name} Â· Easy Club" %>

<section class="mx-auto max-w-4xl space-y-8 px-4 py-10">
  <header class="space-y-2">
    <h1 class="text-3xl font-semibold text-slate-900"><%= @club.name %></h1>
    <% if @club.location? %>
      <p class="text-slate-600">
        <%= [@club.address_line1, @club.city, @club.region, @club.country].compact_blank.join(", ") %>
      </p>
    <% else %>
      <p class="text-slate-500">Location coming soon.</p>
    <% end %>
  </header>

  <% if @club.location? && Settings.google.places_api_key.present? %>
    <div
      class="space-y-3 rounded-lg border border-slate-200 bg-white p-4 shadow"
      data-controller="clubs-map"
      data-clubs-map-api-key-value="<%= Settings.google.places_api_key %>"
      data-clubs-map-clubs-value='<%= [{
        id: @club.id,
        name: @club.name,
        lat: @club.latitude&.to_f,
        lng: @club.longitude&.to_f,
        address_line1: @club.address_line1,
        city: @club.city,
        region: @club.region,
        country: @club.country
      }].to_json.html_safe %>'
    >
      <div class="flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between">
        <button
          type="button"
          class="inline-flex items-center justify-center rounded bg-slate-900 px-3 py-2 text-sm font-medium text-white hover:bg-slate-800 disabled:cursor-not-allowed disabled:bg-slate-400"
          data-action="clubs-map#locateMe"
          data-clubs-map-target="locateButton"
        >
          Use my current location
        </button>
        <p class="text-xs text-slate-500" data-clubs-map-target="status"></p>
      </div>
      <div data-clubs-map-target="map" class="h-64 w-full rounded border border-slate-200"></div>
    </div>
  <% elsif @club.location? %>
    <div class="rounded border border-dashed border-slate-300 bg-white p-6 text-sm text-slate-500">
      Map preview disabled until a Places API key is configured.
    </div>
  <% end %>

  <section class="rounded border border-slate-200 bg-white p-6 shadow-sm">
    <h2 class="text-lg font-semibold text-slate-900">About this club</h2>
    <dl class="mt-4 grid gap-4 text-sm text-slate-600 md:grid-cols-2">
      <% if @club.sender_email.present? %>
        <div>
          <dt class="font-medium text-slate-500">Contact email</dt>
          <dd class="text-slate-900"><%= mail_to @club.sender_email %></dd>
        </div>
      <% end %>
      <% if @club.primary_domain.present? %>
        <div>
          <dt class="font-medium text-slate-500">Website</dt>
          <dd class="text-slate-900"><%= link_to @club.primary_domain, "https://#{@club.primary_domain}", target: "_blank", rel: "noopener" %></dd>
        </div>
      <% end %>
      <% if @club.subdomain.present? %>
        <div>
          <dt class="font-medium text-slate-500">Easy Club subdomain</dt>
          <dd class="text-slate-900"><%= @club.subdomain %>.easyclub.example</dd>
        </div>
      <% end %>
      <% if @club.settings.dig("finance", "currency") %>
        <div>
          <dt class="font-medium text-slate-500">Default currency</dt>
          <dd class="text-slate-900"><%= @club.settings.dig("finance", "currency") %></dd>
        </div>
      <% end %>
    </dl>
  </section>

  <div>
    <%= link_to "Back to clubs", public_clubs_path, class: "text-sm font-medium text-slate-600 hover:text-slate-900" %>
  </div>
</section>
