<% content_for :title, "Payments reconciliation Â· Admin" %>
<% content_for :page_heading, "Payments reconciliation" %>

<section class="rounded-lg border border-slate-200 bg-white shadow-sm">
  <header class="flex items-center justify-between gap-3 border-b border-slate-200 px-4 py-3">
    <h2 class="text-base font-semibold text-slate-900">Recent payment events</h2>
    <%= link_to "Back to invoices", admin_invoices_path, class: "rounded border border-slate-300 px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50" %>
  </header>

  <table class="min-w-full divide-y divide-slate-200 text-sm">
    <thead class="bg-slate-50 text-left text-xs font-semibold uppercase tracking-wide text-slate-500">
      <tr>
        <th class="px-4 py-3">Provider</th>
        <th class="px-4 py-3">Method</th>
        <th class="px-4 py-3">Status</th>
        <th class="px-4 py-3 text-right">Amount</th>
        <th class="px-4 py-3">Invoice</th>
        <th class="px-4 py-3">Received</th>
      </tr>
    </thead>
    <tbody class="divide-y divide-slate-100">
      <% @payments.each do |payment| %>
        <tr class="hover:bg-slate-50">
          <td class="px-4 py-3 text-slate-600"><%= payment.provider %></td>
          <td class="px-4 py-3 text-slate-600"><%= payment.method %></td>
          <td class="px-4 py-3">
            <% badge = payment.status_succeeded? ? "bg-emerald-50 text-emerald-700" : payment.status_failed? ? "bg-rose-50 text-rose-700" : "bg-amber-50 text-amber-700" %>
            <span class="inline-flex rounded-full px-2 py-0.5 text-xs font-medium <%= badge %>"><%= payment.status.humanize %></span>
          </td>
          <td class="px-4 py-3 text-right font-semibold text-slate-900"><%= number_to_currency(payment.amount_cents / 100.0, unit: payment.amount_currency) %></td>
          <td class="px-4 py-3 text-slate-600"><%= link_to payment.invoice.number, admin_invoice_path(payment.invoice), class: "hover:text-slate-700" %></td>
          <td class="px-4 py-3 text-slate-500"><%= payment.created_at %></td>
        </tr>
      <% end %>
    </tbody>
  </table>
</section>
